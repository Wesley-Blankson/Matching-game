<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Matching Game — MVP with Effects</title>
<style>
  :root{
    --bg:#0b1020; --line:#1d2843; --muted:#94a3b8; --text:#e5e7eb;
    --accent:#22d3ee; --accent2:#38bdf8; --ok:#10b981; --bad:#ef4444;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:#0b1020;color:var(--text)}
  header{padding:14px 16px;border-bottom:1px solid var(--line);position:sticky;top:0;background:#0b1020cc;backdrop-filter:blur(6px)}
  .wrap{max-width:900px;margin:0 auto;padding:16px}
  h1{font-size:18px;margin:0 0 6px}
  .sub{margin:0;color:var(--muted);font-size:13px}
  .hud{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
  .box{border:1px solid var(--line);background:#0b1226;border-radius:10px;padding:6px 10px;font-size:14px}
  select,button{border:1px solid var(--line);background:#0b1226;color:var(--text);border-radius:10px;padding:8px 10px}
  button.primary{background:linear-gradient(90deg,var(--accent2),var(--accent));color:#001018;border:none;font-weight:800}
  main{padding-bottom:24px}
  .grid{display:grid;gap:10px;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));margin-top:14px}
  .card{
    user-select:none;border:1px solid var(--line);background:#0b1226;border-radius:12px;padding:14px;min-height:86px;
    display:flex;align-items:center;justify-content:center;text-align:center;transition: transform .12s, border-color .12s, background .12s;
  }
  .card.selected{outline:2px solid var(--accent);outline-offset:-2px}
  .card.correct{background:rgba(16,185,129,.15);border-color:#14532d;animation:pop 220ms ease-out;box-shadow:0 0 0 2px rgba(16,185,129,.35) inset, 0 0 18px rgba(16,185,129,.25)}
  .card.wrong{background:rgba(239,68,68,.08);border-color:#7f1d1d;animation:shake .18s 2}
  @keyframes shake{0%{transform:translateX(0)}25%{transform:translateX(-2px)}75%{transform:translateX(2px)}100%{transform:translateX(0)}}
  @keyframes pop{0%{transform:scale(1)}60%{transform:scale(1.06)}100%{transform:scale(1)}}
  #score.pulse{animation:scorePulse 360ms ease-out}
  @keyframes scorePulse{0%{transform:scale(1);color:#e5e7eb}40%{transform:scale(1.25);color:#5eead4}100%{transform:scale(1);color:#e5e7eb}}
  .foot{margin-top:12px;color:var(--muted);font-size:13px}

  /* Confetti particles */
  .confetti{
    position:fixed; pointer-events:none; width:8px; height:8px; border-radius:2px; opacity:.9;
    will-change: transform, opacity;
  }
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>Matching Game — MVP</h1>
    <p class="sub">Tap two cards that belong together. Correct = lock + points. Clear the board to win.</p>
    <div class="hud">
      <div class="box">Score: <span id="score">0</span></div>
      <div class="box">Matches: <span id="found">0</span>/<span id="total">0</span></div>
      <div class="box">Streak: <span id="streak">0</span></div>
      <select id="setSelect">
        <option value="terms">Terms ↔ Definitions</option>
        <option value="concepts">Concepts ↔ Examples</option>
      </select>
      <button id="newRound" class="primary">New round</button>
      <button id="reset">Reset score</button>
    </div>
  </div>
</header>

<main class="wrap">
  <div id="grid" class="grid"></div>
  <p class="foot">We can add images, a timer, and your own study sets next.</p>
</main>

<script>
  // --- Data ---
  const SETS = {
    terms: [
      ["Photosynthesis","Plants make food using light"],
      ["Neuron","A nerve cell that transmits signals"],
      ["Velocity","Speed with direction"],
      ["Osmosis","Water diffusion across a membrane"],
      ["Mitochondria","Cell's energy producer"],
      ["Gravity","Attraction between masses"]
    ],
    concepts: [
      ["Metaphor","'Time is a thief.'"],
      ["Alliteration","'Wild winds whistle'"],
      ["Simile","'As light as a feather'"],
      ["Hyperbole","'I'm so hungry I could eat a horse'"],
      ["Oxymoron","'Deafening silence'"],
      ["Onomatopoeia","'Buzz', 'clang', 'sizzle'"]
    ]
  };

  // --- State ---
  let deck=[], first=null, lock=false, score=0, found=0, totalPairs=0, streak=0;

  // --- Els ---
  const grid = document.getElementById('grid');
  const scoreEl = document.getElementById('score');
  const foundEl = document.getElementById('found');
  const totalEl = document.getElementById('total');
  const streakEl = document.getElementById('streak');
  const setSelect = document.getElementById('setSelect');
  const btnNew = document.getElementById('newRound');
  const btnReset = document.getElementById('reset');

  // Utils
  function uid(){ return 'id_'+Math.random().toString(36).slice(2); }
  function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=(Math.random()*(i+1))|0; [a[i],a[j]]=[a[j],a[i]]; } return a; }
  function centerOf(el){ const r=el.getBoundingClientRect(); return {x:r.left+r.width/2, y:r.top+r.height/2}; }

  // Effects
  function confettiBurst(x, y, count = 18) {
    const colors = ['#5eead4','#22d3ee','#a78bfa','#f472b6','#f59e0b','#10b981'];
    for (let i = 0; i < count; i++) {
      const el = document.createElement('div');
      el.className = 'confetti';
      el.style.left = x + 'px';
      el.style.top = y + 'px';
      el.style.background = colors[(Math.random()*colors.length)|0];
      document.body.appendChild(el);

      const angle = Math.random() * Math.PI * 2;
      const dist = 40 + Math.random() * 60;
      const dx = Math.cos(angle) * dist;
      const dy = Math.sin(angle) * dist;
      const rot = (Math.random()*360)|0;

      el.animate(
        [{ transform:'translate(0,0) rotate(0deg)', opacity:1 },
         { transform:`translate(${dx}px,${dy}px) rotate(${rot}deg)`, opacity:0 }],
        { duration: 600 + Math.random()*400, easing: 'cubic-bezier(.2,.8,.2,1)' }
      );
      setTimeout(()=> el.remove(), 1100);
    }
  }
  function pulseScore(){
    scoreEl.classList.remove('pulse'); void scoreEl.offsetWidth; scoreEl.classList.add('pulse');
  }

  // Build & render
  function buildDeck(pairs){
    totalPairs = pairs.length;
    const cards=[];
    pairs.forEach((p,idx)=>{
      cards.push({id:uid(),text:p[0],pairId:idx,side:0});
      cards.push({id:uid(),text:p[1],pairId:idx,side:1});
    });
    return shuffle(cards);
  }

  function render(){
    grid.innerHTML='';
    deck.forEach(card=>{
      const div=document.createElement('div');
      div.className='card';
      div.textContent=card.text;
      div.addEventListener('click',()=>onCardClick(div,card));
      grid.appendChild(div);
    });
    scoreEl.textContent=score; foundEl.textContent=found; totalEl.textContent=totalPairs; streakEl.textContent=streak;
  }

  // Core mechanic
  function onCardClick(el,card){
    if(lock||el.classList.contains('correct')) return;
    if(!first){ first={el,card}; el.classList.add('selected'); return; }
    if(first.card.id===card.id){ first.el.classList.remove('selected'); first=null; return; }
    el.classList.add('selected'); lock=true;

    if(first.card.pairId===card.pairId && first.card.side!==card.side){
      // MATCH
      streak+=1; score+=10+Math.min(20,streak*2); found+=1;
      first.el.classList.add('correct'); el.classList.add('correct');

      // Effects: score pulse + confetti between the two cards
      pulseScore();
      const c1 = centerOf(el), c2 = centerOf(first.el);
      confettiBurst((c1.x + c2.x)/2, (c1.y + c2.y)/2);

      setTimeout(()=>{
        first.el.classList.remove('selected'); el.classList.remove('selected');
        afterPick();
      },150);
    }else{
      // MISS
      streak=0; score=Math.max(0,score-2);
      first.el.classList.add('wrong'); el.classList.add('wrong');
      setTimeout(()=>{
        first.el.classList.remove('selected','wrong'); el.classList.remove('selected','wrong');
        afterPick();
      },350);
    }

    function afterPick(){
      first=null; lock=false;
      scoreEl.textContent=score; streakEl.textContent=streak; foundEl.textContent=found;
      // Optional: small page flash on full clear
      if(found===totalPairs){
        document.body.animate([{filter:'brightness(1)'},{filter:'brightness(1.1)'},{filter:'brightness(1)'}],{duration:500,iterations:2});
      }
    }
  }

  function newRound(){
    found=0; streak=0;
    deck = buildDeck(SETS[setSelect.value]);
    render();
  }
  function resetAll(){ score=0; newRound(); }

  // Events
  btnNew.addEventListener('click', newRound);
  btnReset.addEventListener('click', resetAll);
  setSelect.addEventListener('change', newRound);

  // Init
  newRound();
</script>
</body>
</html>
